Search.setIndex({"docnames": ["index", "readme"], "filenames": ["index.rst", "readme.md"], "titles": ["lit-data", "Transform data at scale. Optimize for fast model training."], "terms": {"transform": 0, "scale": 0, "optim": 0, "fast": 0, "model": 0, "train": 0, "quick": 0, "speed": 0, "up": 0, "dataset": 0, "us": 0, "local": 0, "s3": 0, "folder": 0, "resiz": 0, "input": 0, "imag": 0, "kei": 0, "featur": 0, "boto3": 0, "compat": 0, "storag": 0, "option": 0, "custom": 0, "endpoint": 0, "s5cmd": 0, "note": 0, "If": 0, "i": 0, "instal": 0, "default": 0, "oper": 0, "you": 0, "prefer": 0, "can": 0, "disabl": 0, "set": 0, "environ": 0, "variabl": 0, "disable_s5cmd": 0, "1": 0, "initi": 0, "streamingdataset": 0, "cach": 0, "directori": 0, "To": 0, "download": 0, "high": 0, "bandwidth": 0, "network": 0, "defin": 0, "hug": 0, "face": 0, "uri": 0, "creat": 0, "stream": 0, "print": 0, "first": 0, "sampl": 0, "streamingdataload": 0, "index": [0, 1], "modul": 0, "search": 0, "page": [0, 1], "contain": 1, "ai": 1, "raw": 1, "html": 1, "pre": 1, "parallel": 1, "process": 1, "larg": 1, "cloud": 1, "vector": 1, "embed": 1, "acceler": 1, "20x": 1, "run": 1, "distribut": 1, "infer": 1, "paus": 1, "resum": 1, "scrape": 1, "websit": 1, "remot": 1, "without": 1, "load": 1, "pypi": 1, "licens": 1, "p": 1, "align": 1, "center": 1, "lightn": 1, "benchmark": 1, "templat": 1, "commun": 1, "litdata": 1, "task": 1, "__": 1, "creation": 1, "machin": 1, "It": 1, "also": 1, "enabl": 1, "work": 1, "code": 1, "bash": 1, "pip": 1, "choos": 1, "your": 1, "workflow": 1, "advanc": 1, "all": 1, "extra": 1, "faster": 1, "directli": 1, "from": 1, "like": 1, "subset": 1, "access": 1, "individu": 1, "step": 1, "thi": 1, "format": 1, "The": 1, "written": 1, "chunk": 1, "binari": 1, "python": 1, "import": 1, "numpi": 1, "np": 1, "pil": 1, "ld": 1, "def": 1, "random_imag": 1, "fake_imag": 1, "fromarrai": 1, "random": 1, "randint": 1, "0": 1, "256": 1, "32": 1, "3": 1, "dtype": 1, "uint8": 1, "fake_label": 1, "10": 1, "ani": 1, "valu": 1, "pair": 1, "type": 1, "must": 1, "chang": 1, "between": 1, "list": 1, "alwai": 1, "same": 1, "number": 1, "element": 1, "class": 1, "return": 1, "name": 1, "main": 1, "function": 1, "write": 1, "an": 1, "fn": 1, "appli": 1, "each": 1, "rang": 1, "1000": 1, "here": 1, "": 1, "output_dir": 1, "fast_data": 1, "store": 1, "num_work": 1, "4": 1, "worker": 1, "chunk_byt": 1, "64mb": 1, "size": 1, "2": 1, "put": 1, "upload": 1, "studio": 1, "http": 1, "back": 1, "own": 1, "bucket": 1, "aw": 1, "cp": 1, "recurs": 1, "my": 1, "dure": 1, "replac": 1, "pytorch": 1, "dataload": 1, "train_dataset": 1, "shuffl": 1, "true": 1, "drop_last": 1, "train_dataload": 1, "img": 1, "cl": 1, "benefit": 1, "librari": 1, "fabric": 1, "easi": 1, "collabor": 1, "share": 1, "streamlin": 1, "team": 1, "project": 1, "across": 1, "gpu": 1, "automat": 1, "flexibl": 1, "gc": 1, "azur": 1, "account": 1, "compress": 1, "reduc": 1, "footprint": 1, "algorithm": 1, "auto": 1, "enterpris": 1, "secur": 1, "self": 1, "host": 1, "map": 1, "mani": 1, "onc": 1, "exampl": 1, "crop": 1, "input_dir": 1, "my_large_imag": 1, "my_resized_imag": 1, "o": 1, "path": 1, "join": 1, "f": 1, "listdir": 1, "resize_imag": 1, "image_path": 1, "output_image_path": 1, "basenam": 1, "open": 1, "224": 1, "save": 1, "time": 1, "multipl": 1, "simultan": 1, "increas": 1, "effici": 1, "handl": 1, "usecas": 1, "internet": 1, "etc": 1, "need": 1, "comput": 1, "space": 1, "imagin": 1, "re": 1, "huge": 1, "amount": 1, "onlin": 1, "instead": 1, "wait": 1, "hour": 1, "almost": 1, "immedi": 1, "ve": 1, "follow": 1, "batch_siz": 1, "64": 1, "batch": 1, "logic": 1, "addition": 1, "inject": 1, "client": 1, "connect": 1, "amazonaw": 1, "com": 1, "v1": 1, "document": 1, "api": 1, "latest": 1, "refer": 1, "core": 1, "session": 1, "gcp": 1, "when": 1, "specifi": 1, "credenti": 1, "per": 1, "storage_opt": 1, "endpoint_url": 1, "your_endpoint_url": 1, "aws_access_key_id": 1, "your_access_key_id": 1, "aws_secret_access_kei": 1, "your_secret_access_kei": 1, "s3_endpoint_url": 1, "requir": 1, "onli": 1, "altern": 1, "want": 1, "specif": 1, "locat": 1, "cache_dir": 1, "favorit": 1, "simpli": 1, "pass": 1, "its": 1, "url": 1, "how": 1, "get": 1, "hf": 1, "github": 1, "user": 1, "attach": 1, "asset": 1, "3ba9e2ef": 1, "bf6b": 1, "41fc": 1, "a578": 1, "e4b4113a0e72": 1, "prerequisit": 1, "depend": 1, "sh": 1, "huggingface_hub": 1, "hf_transfer": 1, "export": 1, "hf_hub_enable_hf_transf": 1, "hf_dataset_uri": 1, "leonardpku": 1, "clevr_cogen_a_train": 1, "don": 1, "t": 1, "worri": 1, "about": 1, "other": 1, "setup": 1, "necessari": 1, "json": 1, "file": 1, "so": 1, "won": 1, "have": 1, "again": 1, "ensur": 1, "next": 1, "skip": 1, "hasn": 1, "been": 1, "yet": 1, "index_hf_dataset": 1, "method": 1, "abov": 1, "ahead": 1, "make": 1, "abit": 1, "avoid": 1, "real": 1, "gate": 1, "hf_token": 1, "For": 1, "huggingfac": 1, "support": 1, "parquet": 1, "full": 1, "control": 1, "over": 1, "where": 1, "configur": 1, "thought": 1, "openthought": 1, "114k": 1, "index_parquet_dataset": 1, "dir": 1, "now": 1, "parquetload": 1, "item_load": 1, "index_path": 1, "v": 1, "todo": 1, "updat": 1, "below": 1, "imagenet": 1, "155": 1, "gb": 1, "demonstr": 1, "result": 1, "smaller": 1, "output": 1, "compar": 1, "throughput": 1, "second": 1, "sec": 1, "45": 1, "283": 1, "17": 1, "4000": 1, "4700": 1, "51": 1, "465": 1, "96": 1, "3600": 1, "3900": 1, "n": 1, "A": 1, "6": 1, "overhead": 1, "detail": 1, "summari": 1, "multi": 1, "node": 1, "sure": 1, "rank": 1, "receiv": 1, "quantiti": 1, "vari": 1, "out": 1, "box": 1, "framework": 1, "doc": 1, "stabl": 1, "org": 1, "do": 1, "see": 1, "illustr": 1, "show": 1, "under": 1, "hood": 1, "forget": 1, "val_dataset": 1, "val": 1, "fals": 1, "val_dataload": 1, "provid": 1, "read": 1, "common": 1, "googl": 1, "blob": 1, "ar": 1, "aws_storage_opt": 1, "aws_endpoint_url": 1, "unsign": 1, "request": 1, "aws_no_sign_request": 1, "ye": 1, "gcp_storage_opt": 1, "project_id": 1, "g": 1, "azure_storage_opt": 1, "account_url": 1, "azure_account_nam": 1, "window": 1, "net": 1, "azure_account_access_kei": 1, "long": 1, "interrupt": 1, "pick": 1, "right": 1, "left": 1, "off": 1, "issu": 1, "state": 1, "e": 1, "whenev": 1, "info": 1, "wa": 1, "lit": 1, "gpt": 1, "pretrain": 1, "tinyllama": 1, "py": 1, "llm": 1, "restart": 1, "older": 1, "checkpoint": 1, "critic": 1, "due": 1, "sever": 1, "failur": 1, "cuda": 1, "error": 1, "torch": 1, "cpu_count": 1, "restor": 1, "exist": 1, "isfil": 1, "dataloader_st": 1, "pt": 1, "state_dict": 1, "load_state_dict": 1, "iter": 1, "batch_idx": 1, "enumer": 1, "everi": 1, "highli": 1, "we": 1, "token": 1, "entir": 1, "consum": 1, "pathlib": 1, "zstandard": 1, "zstd": 1, "tokensload": 1, "functool": 1, "partial": 1, "convert": 1, "text": 1, "within": 1, "jsonl": 1, "tokenize_fn": 1, "filepath": 1, "none": 1, "rb": 1, "rt": 1, "encod": 1, "utf": 1, "8": 1, "row": 1, "meta": 1, "redpajama_set_nam": 1, "redpajamagithub": 1, "continu": 1, "exclud": 1, "sinc": 1, "overlap": 1, "starcod": 1, "text_id": 1, "bo": 1, "eo": 1, "yield": 1, "__name__": 1, "__main__": 1, "gener": 1, "go": 1, "slimpajama": 1, "str": 1, "627b": 1, "rglob": 1, "zst": 1, "wherev": 1, "teamspac": 1, "s3_connect": 1, "llama": 1, "7b": 1, "chunk_siz": 1, "2049": 1, "8012": 1, "inform": 1, "contigu": 1, "1d": 1, "arrai": 1, "metadata": 1, "concaten": 1, "form": 1, "one": 1, "tensor": 1, "tqdm": 1, "becaus": 1, "word": 1, "well": 1, "block_siz": 1, "2048": 1, "pin_memori": 1, "filter": 1, "illeg": 1, "sometim": 1, "bad": 1, "includ": 1, "With": 1, "good": 1, "should_keep": 1, "bool": 1, "only_even_index_optim": 1, "992": 1, "994": 1, "996": 1, "998": 1, "even": 1, "try": 1, "expect": 1, "except": 1, "only_defined_ratio_optim": 1, "thei": 1, "rais": 1, "divis": 1, "zero": 1, "5": 1, "25": 1, "combin": 1, "mix": 1, "match": 1, "differ": 1, "experi": 1, "better": 1, "combinedstreamingdataset": 1, "As": 1, "mixtur": 1, "co": 1, "cerebra": 1, "bigcod": 1, "starcoderdata": 1, "jzhang38": 1, "1b": 1, "trillion": 1, "loader": 1, "proport": 1, "weight": 1, "693584": 1, "306416": 1, "combined_dataset": 1, "seed": 1, "42": 1, "iterate_over_al": 1, "merg": 1, "merge_dataset": 1, "out_dir": 1, "fast_data_1": 1, "fast_data_2": 1, "fast_data_3": 1, "fast_data_4": 1, "250": 1, "merged_out_dir": 1, "merged_fast_data": 1, "len": 1, "split": 1, "test": 1, "train_test_split": 1, "displai": 1, "length": 1, "100": 1, "000": 1, "test_dataset": 1, "30": 1, "20": 1, "50": 1, "manag": 1, "portion": 1, "resourc": 1, "subsampl": 1, "01": 1, "upsampl": 1, "sourc": 1, "repeat": 1, "floor": 1, "possibli": 1, "copi": 1, "remaind": 1, "250000": 1, "easili": 1, "modifi": 1, "add": 1, "new": 1, "fresh": 1, "assum": 1, "immut": 1, "howev": 1, "decis": 1, "them": 1, "mode": 1, "either": 1, "append": 1, "overwrit": 1, "some": 1, "my_optimized_dataset": 1, "later": 1, "more": 1, "200": 1, "d": 1, "assert": 1, "delet": 1, "alreadi": 1, "assumpt": 1, "amazon": 1, "s3f": 1, "gcsf": 1, "point": 1, "pq_dataset_uri": 1, "facebook": 1, "achiev": 1, "ratio": 1, "34x": 1, "simpl": 1, "8kb": 1, "646b": 1, "look": 1, "part": 1, "whole": 1, "thing": 1, "42th": 1, "fit": 1, "subclass": 1, "overrid": 1, "__getitem__": 1, "torchvis": 1, "v2": 1, "imagenetstreamingdataset": 1, "super": 1, "shape": 1, "profil": 1, "measur": 1, "being": 1, "improv": 1, "profile_batch": 1, "argument": 1, "chrome": 1, "trace": 1, "call": 1, "Then": 1, "visual": 1, "browser": 1, "insid": 1, "memori": 1, "too": 1, "much": 1, "en": 1, "wikipedia": 1, "wiki": 1, "apache_parquet": 1, "keyword": 1, "item": 1, "program": 1, "pyarrow": 1, "pq": 1, "parquet_fil": 1, "parquetfil": 1, "ram": 1, "usag": 1, "iter_batch": 1, "8192": 1, "column": 1, "content": 1, "to_panda": 1, "roughli": 1, "limit": 1, "disk": 1, "temporari": 1, "prevent": 1, "adapt": 1, "stai": 1, "low": 1, "max_cache_s": 1, "10gb": 1, "should": 1, "retriev": 1, "particularli": 1, "organ": 1, "data_dir": 1, "drive": 1, "perform": 1, "site": 1, "On": 1, "prem": 1, "mount": 1, "devic": 1, "area": 1, "In": 1, "order": 1, "overload": 1, "workload": 1, "hundr": 1, "complet": 1, "week": 1, "minut": 1, "enough": 1, "num_nod": 1, "my_output": 1, "data_prep": 1, "select": 1, "dozen": 1, "present": 1, "job": 1, "job_nam": 1, "otherwis": 1, "2024": 1, "07": 1, "08": 1, "encrypt": 1, "decrypt": 1, "level": 1, "sensit": 1, "protect": 1, "fernetencrypt": 1, "util": 1, "password": 1, "fernet": 1, "your_secure_password": 1, "optimized_data": 1, "purpos": 1, "fake_img": 1, "255": 1, "while": 1, "pem": 1, "implement": 1, "customencrypt": 1, "allow": 1, "remain": 1, "maintain": 1, "debug": 1, "log": 1, "litrac": 1, "come": 1, "built": 1, "capabl": 1, "help": 1, "debugg": 1, "enable_trac": 1, "warn": 1, "remov": 1, "litdata_debug": 1, "befor": 1, "ll": 1, "deependujha": 1, "recommend": 1, "system": 1, "command": 1, "visit": 1, "releas": 1, "appropri": 1, "instruct": 1, "convers": 1, "litdata_trac": 1, "w": 1, "ui": 1, "perfetto": 1, "dev": 1, "view": 1, "depth": 1, "insight": 1, "sql": 1, "queri": 1, "analyz": 1, "veri": 1, "2gb": 1, "nativ": 1, "rpc": 1, "server": 1, "brave": 1, "ha": 1, "observ": 1, "doe": 1, "autodetect": 1, "effort": 1, "could": 1, "take": 1, "persist": 1, "section": 1, "reproduc": 1, "non": 1, "2x": 1, "solut": 1, "2m": 1, "1st": 1, "2nd": 1, "epoch": 1, "float32": 1, "torch16": 1, "5839": 1, "6692": 1, "6282": 1, "7221": 1, "web": 1, "3134": 1, "3924": 1, "3343": 1, "4424": 1, "mosaic": 1, "ml": 1, "2898": 1, "5099": 1, "2809": 1, "5158": 1, "www": 1, "281": 1, "167": 1, "cloudflar": 1, "r2": 1, "5335": 1, "5630": 1, "5x": 1, "than": 1, "million": 1, "05": 1, "min": 1, "00": 1, "143": 1, "339": 1, "36": 1, "22": 1, "147": 1, "144": 1, "49": 1, "04": 1, "298": 1, "linearli": 1, "paralleliz": 1, "let": 1, "sai": 1, "56": 1, "emb": 1, "singl": 1, "a10g": 1, "ad": 1, "28": 1, "14": 1, "875": 1, "script": 1, "laion": 1, "400": 1, "cpu": 1, "explor": 1, "400million": 1, "world": 1, "applic": 1, "m": 1, "achin": 1, "120": 1, "400m": 1, "da": 1, "taset": 1, "lightnin": 1, "studi": 1, "blog": 1, "op": 1, "et": 1, "swedish": 1, "7": 1, "wikip": 1, "ticl": 1, "lightni": 1, "ia": 1, "htt": 1, "ng": 1, "stud": 1, "hu": 1, "io": 1, "ggingfa": 1, "articl": 1, "ce": 1, "ataset": 1, "dia": 1, "english": 1, "15": 1, "llar": 1, "dollar": 1, "label": 1, "magenet": 1, "1m": 1, "paper": 1, "swithco": 1, "de": 1, "sota": 1, "im": 1, "ag": 1, "cla": 1, "ssifica": 1, "tion": 1, "imagen": 1, "tag_": 1, "171": 1, "geospati": 1, "che": 1, "mask": 1, "sapeak": 1, "road": 1, "light": 1, "spatial": 1, "ning": 1, "conv": 1, "c": 1, "li": 1, "ontext": 1, "ghtning": 1, "githu": 1, "b": 1, "saaccor": 1, "lei": 1, "rsc": 1, "240": 1, "sl": 1, "1t": 1, "impajam": 1, "gingfac": 1, "prepar": 1, "slimp": 1, "ajama": 1, "27b": 1, "starc": 1, "oder": 1, "h": 1, "ttp": 1, "datas": 1, "bigc": 1, "od": 1, "sta": 1, "rcoderd": 1, "ata": 1, "12": 1, "16": 1, "r": 1, "andomli": 1, "ge": 1, "l": 1, "nerat": 1, "ightn": 1, "onvert": 1, "accept": 1, "contribut": 1, "most": 1, "discord": 1, "invit": 1, "xncpty7dst": 1, "apach": 1, "citat": 1, "misc": 1, "litdata2023": 1, "author": 1, "thoma": 1, "chaton": 1, "titl": 1, "year": 1, "2023": 1, "howpublish": 1, "2025": 1, "09": 1, "toward": 1, "interpret": 1, "protein": 1, "structur": 1, "predict": 1, "spars": 1, "autoencod": 1, "arxiv": 1, "pdf": 1, "2503": 1, "08764": 1, "johnyang101": 1, "reticular": 1, "sae": 1, "nithin": 1, "parsan": 1, "david": 1, "j": 1, "yang": 1, "john": 1, "govern": 1, "tchaton": 1, "luca": 1, "antiga": 1, "lantiga": 1, "justu": 1, "schock": 1, "justusschock": 1, "bhimraj": 1, "yadav": 1, "bhimrazi": 1, "deependu": 1, "jirka": 1, "borda": 1, "emeritu": 1, "adrian": 1, "w\u00e4lchli": 1, "awaelchli": 1, "shield": 1, "dm": 1}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"lit": 0, "data": [0, 1], "start": [0, 1], "here": 0, "indic": 0, "tabl": 0, "transform": 1, "scale": 1, "optim": 1, "fast": 1, "model": 1, "train": 1, "quick": 1, "speed": 1, "up": 1, "dataset": 1, "us": 1, "local": 1, "s3": 1, "folder": 1, "resiz": 1, "input": 1, "imag": 1, "kei": 1, "featur": 1, "stream": 1, "boto3": 1, "compat": 1, "storag": 1, "option": 1, "custom": 1, "endpoint": 1, "s5cmd": 1, "note": 1, "If": 1, "i": 1, "instal": 1, "default": 1, "oper": 1, "you": 1, "prefer": 1, "can": 1, "disabl": 1, "set": 1, "environ": 1, "variabl": 1, "disable_s5cmd": 1, "1": 1, "initi": 1, "streamingdataset": 1, "cach": 1, "directori": 1, "To": 1, "download": 1, "high": 1, "bandwidth": 1, "network": 1, "defin": 1, "hug": 1, "face": 1, "uri": 1, "creat": 1, "print": 1, "first": 1, "sampl": 1, "streamingdataload": 1}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"lit-data": [[0, "lit-data"]], "Start here": [[0, null]], "Indices and tables": [[0, "indices-and-tables"]], "Transform data at scale. Optimize for fast model training.": [[1, "transform-data-at-scale-optimize-for-fast-model-training"]], "Quick start": [[1, "quick-start"]], "Speed up model training": [[1, "speed-up-model-training"]], "Transform datasets": [[1, "transform-datasets"]], "use a local or S3 folder": [[1, "use-a-local-or-s3-folder"]], "resize the input image": [[1, "resize-the-input-image"]], "Key Features": [[1, "key-features"]], "Features for optimizing and streaming datasets for model training": [[1, "features-for-optimizing-and-streaming-datasets-for-model-training"]], "boto3 compatible storage options for a custom S3-compatible endpoint": [[1, "boto3-compatible-storage-options-for-a-custom-s3-compatible-endpoint"]], "s5cmd compatible storage options for a custom S3-compatible endpoint": [[1, "s5cmd-compatible-storage-options-for-a-custom-s3-compatible-endpoint"]], "Note: If s5cmd is installed, it will be used by default for S3 operations. If you prefer not to use s5cmd, you can disable it by setting the environment variable: DISABLE_S5CMD=1": [[1, "note-if-s5cmd-is-installed-it-will-be-used-by-default-for-s3-operations-if-you-prefer-not-to-use-s5cmd-you-can-disable-it-by-setting-the-environment-variable-disable-s5cmd-1"]], "Initialize the StreamingDataset with the custom cache directory": [[1, "initialize-the-streamingdataset-with-the-custom-cache-directory"]], "Optional: To speed up downloads on high-bandwidth networks": [[1, "optional-to-speed-up-downloads-on-high-bandwidth-networks"]], "Define the Hugging Face dataset URI": [[1, "define-the-hugging-face-dataset-uri"]], "Create a streaming dataset": [[1, "create-a-streaming-dataset"]], "Print the first sample": [[1, "print-the-first-sample"]], "Stream the dataset using StreamingDataLoader": [[1, "stream-the-dataset-using-streamingdataloader"]]}, "indexentries": {}})